/** 
* @version 2.1.11
* @license MIT
*/
!function(e,t){"use strict";e.module("smart-table",[]).run(["$templateCache",function(e){e.put("template/smart-table/pagination.html",'<nav ng-if="numPages && pages.length >= 2"><ul class="pagination"><li ng-repeat="page in pages" ng-class="{active: page==currentPage}"><a href="javascript: void(0);" ng-click="selectPage(page)">{{page}}</a></li></ul></nav>'),e.put("sttable/template/st-tree-toggle.html",'<span ng-class="spacerClass"></span><i ng-if="toggleExists" ng-class="toggleIsExpanded ? \'fa fa-caret-down\' : \'fa fa-caret-right\'"></i>\n')}]),e.module("smart-table").constant("stConfig",{pagination:{template:"template/smart-table/pagination.html",itemsByPage:10,displayedPages:5},search:{delay:400,inputEvent:"input"},select:{mode:"single",selectedClass:"st-selected"},sort:{ascentClass:"st-sort-ascent",descentClass:"st-sort-descent",descendingFirst:!1,skipNatural:!1,delay:300},pipe:{delay:100},tree:{nodesInitiallyOpen:!0}}),e.module("smart-table").controller("stTableController",["$scope","$parse","$filter","$attrs","stConfig",function(n,a,s,r,i){function l(e){var t=e?[].concat(e):[];return x&&u(t),t}function o(){O=l(f(n)),T===!0&&E.pipe()}function c(e,t){if(-1!=t.indexOf(".")){var n=t.split("."),s=n.pop(),r=n.join("."),i=a(r)(e);delete i[s],0===Object.keys(i).length&&c(e,r)}else delete e[t]}function u(e){function t(t,n){for(var s=[],r=n;r>=0;r--)if(e[r].treeLevel>t.treeLevel)return s.push(e[r].$$treeId),a[e[r].$$treeId]=!0,e[r].$$treeDescendents.push(n),s.concat(e[r].$$treeAncestors);return s}function n(e){return angular.isObject(k)?k.hasOwnProperty(e)?k[e]:i.tree.nodesInitiallyOpen:k}e.forEach(function(e,t){e.$$treeId||(e.$$treeId=e.treeLevel.toString()+t+Math.floor(1e4*Math.random()))});var a={};e.forEach(function(e,a){e.treeLevel>0&&(e.$$treeDescendents=[],e.hasOwnProperty("$$treeIsExpanded")||(e.$$treeIsExpanded=n(e.treeLevel))),e.$$treeAncestors=t(e,a),e.$$treeShown=e.treeLevel>0}),Object.keys(a).forEach(function(t){if(!D.hasOwnProperty(t)){for(var n,a=0;a<e.length;a++)if(e[a].$$treeId===t){n=e[a];break}D[t]=n.$$treeIsExpanded}}),e.forEach(function(t,n){t.treeLevel>0&&p(e,n)})}function p(e,t){e[t].$$treeDescendents.forEach(function(t){var n=!0;e[t].$$treeAncestors.forEach(function(e){n=n&&D[e]}),e[t].$$treeShown=n,e[t].$$treeDescendents&&p(e,t)})}function g(){var e=a(r.stTreeInitOpen),t=e(n);if(angular.isObject(t)){var s={};for(var i in t)s[i]=Boolean(JSON.parse(t[i]));return s}return Boolean(JSON.parse(t.toLowerCase()))}function d(){$=n.$watch(function(){return v(n)},function(e,t){e&&e!==t&&b.select(e,"single")})}var f,h,m,v,$,b=this,S=r.stTable,P=a(S),y=P.assign,C=s("orderBy"),I=s("filter"),O=l(P(n)),w={sort:{},search:{},pagination:{start:0,totalItemCount:0}},T=!0,E=this,x="stTreeTable"in r,D={},k="stTreeInitOpen"in r?g():i.tree.nodesInitiallyOpen;r.stSelectedRow&&(v=a(r.stSelectedRow)),r.stSafeSrc&&(f=a(r.stSafeSrc),n.$watch(function(){var e=f(n);return e&&e.length?e[0]:t},function(e,t){e!==t&&o()}),n.$watch(function(){var e=f(n);return e?e.length:0},function(e){e!==O.length&&o()}),n.$watch(function(){return f(n)},function(e,t){e!==t&&(w.pagination.start=0,o())})),this.sortBy=function(t,n){return w.sort.predicate=t,w.sort.reverse=n===!0,e.isFunction(t)?w.sort.functionName=t.name:delete w.sort.functionName,w.pagination.start=0,this.pipe()},this.search=function(t,n){var s=w.search.predicateObject||{},r=n?n:"$";return t=e.isString(t)?t.trim():t,a(r).assign(s,t),t||c(s,r),w.search.predicateObject=s,w.pagination.start=0,this.pipe()},this.pipe=function(){var e,a=w.pagination;h=w.search.predicateObject?I(O,w.search.predicateObject):O,w.sort.predicate&&(h=C(h,w.sort.predicate,w.sort.reverse)),a.totalItemCount=h.length,a.number!==t&&(a.numberOfPages=h.length>0?Math.ceil(h.length/a.number):1,a.start=a.start>=h.length?(a.numberOfPages-1)*a.number:a.start,e=h.slice(a.start,a.start+parseInt(a.number))),y(n,e||h)},this.select=function(e,a){var s=l(P(n)),i=s.indexOf(e);-1!==i?"single"===a?(e.isSelected=e.isSelected!==!0,m&&(m.isSelected=!1),r.stSelectedRow&&($(),v.assign(n,e),d()),m=e.isSelected===!0?e:t):s[i].isSelected=!s[i].isSelected:r.stSelectedRow&&(m.isSelected=!1,m=t)},this.slice=function(e,t){return w.pagination.start=e,w.pagination.number=t,this.pipe()},this.tableState=function(){return w},this.getFilteredCollection=function(){return h||O},this.setFilterFunction=function(e){I=s(e)},this.setSortFunction=function(e){C=s(e)},this.preventPipeOnWatch=function(){T=!1},this.toggleRow=function(e,t){D[e]=!D[e],O[t].$$treeIsExpanded=D[e],n.$apply(function(){p(O,t)})},this.checkExpanded=function(e){return D[e]},r.stSelectedRow&&d()}]).directive("stTable",function(){return{restrict:"A",controller:"stTableController",link:function(e,t,n,a){n.stSetFilter&&a.setFilterFunction(n.stSetFilter),n.stSetSort&&a.setSortFunction(n.stSetSort)}}}),e.module("smart-table").directive("stSearch",["stConfig","$timeout","$parse",function(e,t,n){return{require:"^stTable",link:function(a,s,r,i){var l=i,o=null,c=r.stDelay||e.search.delay,u=r.stInputEvent||e.search.inputEvent;r.$observe("stSearch",function(e,t){var n=s[0].value;e!==t&&n&&(i.tableState().search={},l.search(n,e))}),a.$watch(function(){return i.tableState().search},function(e){var t=r.stSearch||"$";e.predicateObject&&n(t)(e.predicateObject)!==s[0].value&&(s[0].value=n(t)(e.predicateObject)||"")},!0),s.bind(u,function(e){e=e.originalEvent||e,null!==o&&t.cancel(o),o=t(function(){l.search(e.target.value,r.stSearch||""),o=null},c)})}}}]),e.module("smart-table").directive("stSelectRow",["stConfig",function(e){return{restrict:"A",require:"^stTable",scope:{row:"=stSelectRow",onSelect:"=?stOnSelect"},link:function(t,n,a,s){var r=a.stSelectMode||e.select.mode;n.bind("click",function(){t.$apply(function(){s.select(t.row,r),a.stOnSelect&&t.onSelect(t.row)})}),t.$watch("row.isSelected",function(t){t===!0?n.addClass(e.select.selectedClass):n.removeClass(e.select.selectedClass)})}}}]),e.module("smart-table").directive("stSort",["stConfig","$parse","$timeout",function(n,a,s){return{restrict:"A",require:"^stTable",link:function(r,i,l,o){function c(){b?f=0===f?2:f-1:f++;var t;g=e.isFunction(d(r))||e.isArray(d(r))?d(r):l.stSort,f%3===0&&!!$!=!0?(f=0,o.tableState().sort={},o.tableState().pagination.start=0,t=o.pipe.bind(o)):t=o.sortBy.bind(o,g,f%2===0),null!==S&&s.cancel(S),0>P?t():S=s(t,P),p&&p(g,f)}var u,p,g=l.stSort,d=a(g),f=0,h=l.stClassAscent||n.sort.ascentClass,m=l.stClassDescent||n.sort.descentClass,v=[h,m],$=l.stSkipNatural!==t?l.stSkipNatural:n.sort.skipNatural,b=l.stDescendingFirst!==t?l.stDescendingFirst:n.sort.descendingFirst,S=null,P=l.stDelay||n.sort.delay;l.stOnSort&&(p=r.$eval(l.stOnSort)!==t?r.$eval(l.stOnSort):!1),l.stSortDefault&&(u=r.$eval(l.stSortDefault)!==t?r.$eval(l.stSortDefault):l.stSortDefault),i.bind("click",function(){g&&r.$apply(c)}),u&&(f="reverse"===u?1:0,c()),r.$watch(function(){return o.tableState().sort},function(e){e.predicate!==g?(f=0,i.removeClass(h).removeClass(m)):(f=e.reverse===!0?2:1,i.removeClass(v[f%2]).addClass(v[f-1]))},!0)}}}]),e.module("smart-table").directive("stPagination",["stConfig",function(e){return{restrict:"EA",require:"^stTable",scope:{stItemsByPage:"=?",stDisplayedPages:"=?",stPageChange:"&"},templateUrl:function(t,n){return n.stTemplate?n.stTemplate:e.pagination.template},link:function(t,n,a,s){function r(){var e,n,a=s.tableState().pagination,r=1,i=t.currentPage;for(t.totalItemCount=a.totalItemCount,t.currentPage=Math.floor(a.start/a.number)+1,r=Math.max(r,t.currentPage-Math.abs(Math.floor(t.stDisplayedPages/2))),e=r+t.stDisplayedPages,e>a.numberOfPages&&(e=a.numberOfPages+1,r=Math.max(1,e-t.stDisplayedPages)),t.pages=[],t.numPages=a.numberOfPages,n=r;e>n;n++)t.pages.push(n);i!==t.currentPage&&t.stPageChange({newPage:t.currentPage})}t.stItemsByPage=t.stItemsByPage?+t.stItemsByPage:e.pagination.itemsByPage,t.stDisplayedPages=t.stDisplayedPages?+t.stDisplayedPages:e.pagination.displayedPages,t.currentPage=1,t.pages=[],t.$watch(function(){return s.tableState().pagination},r,!0),t.$watch("stItemsByPage",function(e,n){e!==n&&t.selectPage(1)}),t.$watch("stDisplayedPages",r),t.selectPage=function(e){e>0&&e<=t.numPages&&s.slice((e-1)*t.stItemsByPage,t.stItemsByPage)},s.tableState().pagination.number||s.slice(0,t.stItemsByPage)}}}]),e.module("smart-table").directive("stPipe",["stConfig","$timeout",function(t,n){return{require:"stTable",scope:{stPipe:"="},link:{pre:function(a,s,r,i){var l=null;e.isFunction(a.stPipe)&&(i.preventPipeOnWatch(),i.pipe=function(){return null!==l&&n.cancel(l),l=n(function(){a.stPipe(i.tableState(),i)},t.pipe.delay)})},post:function(e,t,n,a){a.pipe()}}}}]),e.module("smart-table").directive("stTreeRow",["stConfig",function(){return{restrict:"A",require:"^stTable",priority:1001,compile:function(e,t){var n=t.ngRepeat,a=n.split(" in ")[0];e.attr("ng-repeat",n+" track by "+a+".$$treeId"),e.attr("ng-if",a+".$$treeShown"),e.attr("ng-class",'"st-tree-row-"+'+a+".treeLevel");var s=angular.element(e.find("td")[0]).find("st-tree-caret");s.attr("toggle-exists",a+".treeLevel > 0"),s.attr("toggle-is-expanded",a+".$$treeIsExpanded"),s.attr("toggle-level",a+".treeLevel"),s.attr("st-tree-id",a+".$$treeId"),s.attr("st-tree-level",a+".treeLevel"),s.attr("st-tree-index","$index")}}}]),e.module("smart-table").directive("stTreeCaret",["stConfig",function(){return{require:"^^stTable",scope:{toggleExists:"<",toggleIsExpanded:"<",toggleLevel:"<",stTreeId:"<",stTreeLevel:"<",stTreeIndex:"<"},templateUrl:"sttable/template/st-tree-toggle.html",link:function(e,t,n,a){e.toggleExists&&t.bind("click",function(t){t.stopPropagation(),a.toggleRow(e.stTreeId,e.stTreeIndex)}),e.spacerClass="st-tree-spacer st-tree-spacer-level-"+e.toggleLevel}}}])}(angular);
//# sourceMappingURL=smart-table.min.js.map
