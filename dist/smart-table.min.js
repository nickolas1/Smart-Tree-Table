/** 
* @version 2.1.8
* @license MIT
*/
!function(e,t){"use strict";e.module("smart-table",[]).run(["$templateCache",function(e){e.put("template/smart-table/pagination.html",'<nav ng-if="numPages && pages.length >= 2"><ul class="pagination"><li ng-repeat="page in pages" ng-class="{active: page==currentPage}"><a href="javascript: void(0);" ng-click="selectPage(page)">{{page}}</a></li></ul></nav>'),e.put("sttable/template/st-tree-toggle.html",'<span ng-class="spacerClass"></span><i ng-if="toggleExists" ng-class="toggleIsExpanded ? \'fa fa-caret-down\' : \'fa fa-caret-right\'"></i>\n')}]),e.module("smart-table").constant("stConfig",{pagination:{template:"template/smart-table/pagination.html",itemsByPage:10,displayedPages:5},search:{delay:400,inputEvent:"input"},select:{mode:"single",selectedClass:"st-selected"},sort:{ascentClass:"st-sort-ascent",descentClass:"st-sort-descent",descendingFirst:!1,skipNatural:!1,delay:300},pipe:{delay:100},tree:{nodesInitiallyOpen:!0}}),e.module("smart-table").controller("stTableController",["$scope","$parse","$filter","$attrs","stConfig",function(n,a,s,r,i){function l(e){var t=e?[].concat(e):[];return I&&u(t),t}function c(){S=l(g(n)),y===!0&&C.pipe()}function o(e,t){if(-1!=t.indexOf(".")){var n=t.split("."),s=n.pop(),r=n.join("."),i=a(r)(e);delete i[s],0===Object.keys(i).length&&o(e,r)}else delete e[t]}function u(e){function t(t,a){for(var s=[],r=a;r>=0;r--)if(e[r].treeLevel>t.treeLevel)return s.push(e[r].$$treeId),n[e[r].$$treeId]=!0,e[r].$$treeDescendents.push(a),s.concat(e[r].$$treeAncestors);return s}e.forEach(function(e,t){e.$$treeId||(e.$$treeId=e.treeLevel.toString()+t+Math.floor(1e4*Math.random()))});var n={};e.forEach(function(e,n){e.treeLevel>0&&(e.$$treeDescendents=[],e.hasOwnProperty("$$treeIsExpanded")||(e.$$treeIsExpanded=O)),e.$$treeAncestors=t(e,n),e.$$treeShown=e.treeLevel>0}),Object.keys(n).forEach(function(e){w.hasOwnProperty(e)||(w[e]=O)}),e.forEach(function(t,n){t.treeLevel>0&&p(e,n)})}function p(e,t){e[t].$$treeDescendents.forEach(function(t){var n=!0;e[t].$$treeAncestors.forEach(function(e){n=n&&w[e]}),e[t].$$treeShown=n,e[t].$$treeDescendents&&p(e,t)})}var g,d,f,h=r.stTable,m=a(h),v=m.assign,$=s("orderBy"),b=s("filter"),S=l(m(n)),P={sort:{},search:{},pagination:{start:0,totalItemCount:0}},y=!0,C=this,I="stTreeTable"in r,w={},O="stTreeInitOpen"in r?Boolean(JSON.parse(r.stTreeInitOpen.toLowerCase())):i.tree.nodesInitiallyOpen;r.stSafeSrc&&(g=a(r.stSafeSrc),n.$watch(function(){var e=g(n);return e&&e.length?e[0]:t},function(e,t){e!==t&&c()}),n.$watch(function(){var e=g(n);return e?e.length:0},function(e){e!==S.length&&c()}),n.$watch(function(){return g(n)},function(e,t){e!==t&&(P.pagination.start=0,c())})),this.sortBy=function(t,n){return P.sort.predicate=t,P.sort.reverse=n===!0,e.isFunction(t)?P.sort.functionName=t.name:delete P.sort.functionName,P.pagination.start=0,this.pipe()},this.search=function(t,n){var s=P.search.predicateObject||{},r=n?n:"$";return t=e.isString(t)?t.trim():t,a(r).assign(s,t),t||o(s,r),P.search.predicateObject=s,P.pagination.start=0,this.pipe()},this.pipe=function(){var e,a=P.pagination;d=P.search.predicateObject?b(S,P.search.predicateObject):S,P.sort.predicate&&(d=$(d,P.sort.predicate,P.sort.reverse)),a.totalItemCount=d.length,a.number!==t&&(a.numberOfPages=d.length>0?Math.ceil(d.length/a.number):1,a.start=a.start>=d.length?(a.numberOfPages-1)*a.number:a.start,e=d.slice(a.start,a.start+parseInt(a.number))),v(n,e||d)},this.select=function(e,a){var s=l(m(n)),r=s.indexOf(e);-1!==r&&("single"===a?(e.isSelected=e.isSelected!==!0,f&&(f.isSelected=!1),f=e.isSelected===!0?e:t):s[r].isSelected=!s[r].isSelected)},this.slice=function(e,t){return P.pagination.start=e,P.pagination.number=t,this.pipe()},this.tableState=function(){return P},this.getFilteredCollection=function(){return d||S},this.setFilterFunction=function(e){b=s(e)},this.setSortFunction=function(e){$=s(e)},this.preventPipeOnWatch=function(){y=!1},this.toggleRow=function(e,t){w[e]=!w[e],S[t].$$treeIsExpanded=w[e],n.$apply(function(){p(S,t)})},this.checkExpanded=function(e){return w[e]}}]).directive("stTable",function(){return{restrict:"A",controller:"stTableController",link:function(e,t,n,a){n.stSetFilter&&a.setFilterFunction(n.stSetFilter),n.stSetSort&&a.setSortFunction(n.stSetSort)}}}),e.module("smart-table").directive("stSearch",["stConfig","$timeout","$parse",function(e,t,n){return{require:"^stTable",link:function(a,s,r,i){var l=i,c=null,o=r.stDelay||e.search.delay,u=r.stInputEvent||e.search.inputEvent;r.$observe("stSearch",function(e,t){var n=s[0].value;e!==t&&n&&(i.tableState().search={},l.search(n,e))}),a.$watch(function(){return i.tableState().search},function(e){var t=r.stSearch||"$";e.predicateObject&&n(t)(e.predicateObject)!==s[0].value&&(s[0].value=n(t)(e.predicateObject)||"")},!0),s.bind(u,function(e){e=e.originalEvent||e,null!==c&&t.cancel(c),c=t(function(){l.search(e.target.value,r.stSearch||""),c=null},o)})}}}]),e.module("smart-table").directive("stSelectRow",["stConfig",function(e){return{restrict:"A",require:"^stTable",scope:{row:"=stSelectRow",onSelect:"=?stOnSelect"},link:function(t,n,a,s){var r=a.stSelectMode||e.select.mode;n.bind("click",function(){t.$apply(function(){s.select(t.row,r),a.stOnSelect&&t.onSelect(t.row)})}),t.$watch("row.isSelected",function(t){t===!0?n.addClass(e.select.selectedClass):n.removeClass(e.select.selectedClass)})}}}]),e.module("smart-table").directive("stSort",["stConfig","$parse","$timeout",function(n,a,s){return{restrict:"A",require:"^stTable",link:function(r,i,l,c){function o(){$?d=0===d?2:d-1:d++;var t;p=e.isFunction(g(r))||e.isArray(g(r))?g(r):l.stSort,d%3===0&&!!v!=!0?(d=0,c.tableState().sort={},c.tableState().pagination.start=0,t=c.pipe.bind(c)):t=c.sortBy.bind(c,p,d%2===0),null!==b&&s.cancel(b),0>S?t():b=s(t,S)}var u,p=l.stSort,g=a(p),d=0,f=l.stClassAscent||n.sort.ascentClass,h=l.stClassDescent||n.sort.descentClass,m=[f,h],v=l.stSkipNatural!==t?l.stSkipNatural:n.sort.skipNatural,$=l.stDescendingFirst!==t?l.stDescendingFirst:n.sort.descendingFirst,b=null,S=l.stDelay||n.sort.delay;l.stSortDefault&&(u=r.$eval(l.stSortDefault)!==t?r.$eval(l.stSortDefault):l.stSortDefault),i.bind("click",function(){p&&r.$apply(o)}),u&&(d="reverse"===u?1:0,o()),r.$watch(function(){return c.tableState().sort},function(e){e.predicate!==p?(d=0,i.removeClass(f).removeClass(h)):(d=e.reverse===!0?2:1,i.removeClass(m[d%2]).addClass(m[d-1]))},!0)}}}]),e.module("smart-table").directive("stPagination",["stConfig",function(e){return{restrict:"EA",require:"^stTable",scope:{stItemsByPage:"=?",stDisplayedPages:"=?",stPageChange:"&"},templateUrl:function(t,n){return n.stTemplate?n.stTemplate:e.pagination.template},link:function(t,n,a,s){function r(){var e,n,a=s.tableState().pagination,r=1,i=t.currentPage;for(t.totalItemCount=a.totalItemCount,t.currentPage=Math.floor(a.start/a.number)+1,r=Math.max(r,t.currentPage-Math.abs(Math.floor(t.stDisplayedPages/2))),e=r+t.stDisplayedPages,e>a.numberOfPages&&(e=a.numberOfPages+1,r=Math.max(1,e-t.stDisplayedPages)),t.pages=[],t.numPages=a.numberOfPages,n=r;e>n;n++)t.pages.push(n);i!==t.currentPage&&t.stPageChange({newPage:t.currentPage})}t.stItemsByPage=t.stItemsByPage?+t.stItemsByPage:e.pagination.itemsByPage,t.stDisplayedPages=t.stDisplayedPages?+t.stDisplayedPages:e.pagination.displayedPages,t.currentPage=1,t.pages=[],t.$watch(function(){return s.tableState().pagination},r,!0),t.$watch("stItemsByPage",function(e,n){e!==n&&t.selectPage(1)}),t.$watch("stDisplayedPages",r),t.selectPage=function(e){e>0&&e<=t.numPages&&s.slice((e-1)*t.stItemsByPage,t.stItemsByPage)},s.tableState().pagination.number||s.slice(0,t.stItemsByPage)}}}]),e.module("smart-table").directive("stPipe",["stConfig","$timeout",function(t,n){return{require:"stTable",scope:{stPipe:"="},link:{pre:function(a,s,r,i){var l=null;e.isFunction(a.stPipe)&&(i.preventPipeOnWatch(),i.pipe=function(){return null!==l&&n.cancel(l),l=n(function(){a.stPipe(i.tableState(),i)},t.pipe.delay)})},post:function(e,t,n,a){a.pipe()}}}}]),e.module("smart-table").directive("stTreeRow",["stConfig",function(){return{restrict:"A",require:"^stTable",priority:1001,compile:function(e,t){var n=t.ngRepeat,a=n.split(" in ")[0];e.attr("ng-repeat",n+" track by "+a+".$$treeId"),e.attr("ng-if",a+".$$treeShown"),e.attr("ng-class",'"st-tree-row-"+'+a+".treeLevel");var s=angular.element(e.find("td")[0]).find("st-tree-caret");s.attr("toggle-exists",a+".treeLevel > 0"),s.attr("toggle-is-expanded",a+".$$treeIsExpanded"),s.attr("toggle-level",a+".treeLevel"),s.attr("st-tree-id",a+".$$treeId"),s.attr("st-tree-level",a+".treeLevel"),s.attr("st-tree-index","$index")}}}]),e.module("smart-table").directive("stTreeCaret",["stConfig",function(){return{require:"^^stTable",scope:{toggleExists:"<",toggleIsExpanded:"<",toggleLevel:"<",stTreeId:"<",stTreeLevel:"<",stTreeIndex:"<"},templateUrl:"sttable/template/st-tree-toggle.html",link:function(e,t,n,a){e.toggleExists&&t.bind("click",function(t){t.stopPropagation(),a.toggleRow(e.stTreeId,e.stTreeIndex)}),e.spacerClass="st-tree-spacer st-tree-spacer-level-"+e.toggleLevel}}}])}(angular);
//# sourceMappingURL=smart-table.min.js.map
