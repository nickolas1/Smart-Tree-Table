/** 
* @version 2.1.9
* @license MIT
*/
!function(e,t){"use strict";e.module("smart-table",[]).run(["$templateCache",function(e){e.put("template/smart-table/pagination.html",'<nav ng-if="numPages && pages.length >= 2"><ul class="pagination"><li ng-repeat="page in pages" ng-class="{active: page==currentPage}"><a href="javascript: void(0);" ng-click="selectPage(page)">{{page}}</a></li></ul></nav>'),e.put("sttable/template/st-tree-toggle.html",'<span ng-class="spacerClass"></span><i ng-if="toggleExists" ng-class="toggleIsExpanded ? \'fa fa-caret-down\' : \'fa fa-caret-right\'"></i>\n')}]),e.module("smart-table").constant("stConfig",{pagination:{template:"template/smart-table/pagination.html",itemsByPage:10,displayedPages:5},search:{delay:400,inputEvent:"input"},select:{mode:"single",selectedClass:"st-selected"},sort:{ascentClass:"st-sort-ascent",descentClass:"st-sort-descent",descendingFirst:!1,skipNatural:!1,delay:300},pipe:{delay:100},tree:{nodesInitiallyOpen:!0}}),e.module("smart-table").controller("stTableController",["$scope","$parse","$filter","$attrs","stConfig",function(n,s,a,r,i){function l(e){var t=e?[].concat(e):[];return D&&u(t),t}function o(){I=l(d(n)),O===!0&&T.pipe()}function c(e,t){if(-1!=t.indexOf(".")){var n=t.split("."),a=n.pop(),r=n.join("."),i=s(r)(e);delete i[a],0===Object.keys(i).length&&c(e,r)}else delete e[t]}function u(e){function t(t,s){for(var a=[],r=s;r>=0;r--)if(e[r].treeLevel>t.treeLevel)return a.push(e[r].$$treeId),n[e[r].$$treeId]=!0,e[r].$$treeDescendents.push(s),a.concat(e[r].$$treeAncestors);return a}e.forEach(function(e,t){e.$$treeId||(e.$$treeId=e.treeLevel.toString()+t+Math.floor(1e4*Math.random()))});var n={};e.forEach(function(e,n){e.treeLevel>0&&(e.$$treeDescendents=[],e.hasOwnProperty("$$treeIsExpanded")||(e.$$treeIsExpanded=x)),e.$$treeAncestors=t(e,n),e.$$treeShown=e.treeLevel>0}),Object.keys(n).forEach(function(e){E.hasOwnProperty(e)||(E[e]=x)}),e.forEach(function(t,n){t.treeLevel>0&&p(e,n)})}function p(e,t){e[t].$$treeDescendents.forEach(function(t){var n=!0;e[t].$$treeAncestors.forEach(function(e){n=n&&E[e]}),e[t].$$treeShown=n,e[t].$$treeDescendents&&p(e,t)})}function g(){v=n.$watch(function(){return m(n)},function(e,t){e&&e!==t&&$.select(e,"single")})}var d,f,h,m,v,$=this,b=r.stTable,S=s(b),P=S.assign,y=a("orderBy"),C=a("filter"),I=l(S(n)),w={sort:{},search:{},pagination:{start:0,totalItemCount:0}},O=!0,T=this,D="stTreeTable"in r,E={},x="stTreeInitOpen"in r?Boolean(JSON.parse(r.stTreeInitOpen.toLowerCase())):i.tree.nodesInitiallyOpen;r.stSelectedRow&&(m=s(r.stSelectedRow)),r.stSafeSrc&&(d=s(r.stSafeSrc),n.$watch(function(){var e=d(n);return e&&e.length?e[0]:t},function(e,t){e!==t&&o()}),n.$watch(function(){var e=d(n);return e?e.length:0},function(e){e!==I.length&&o()}),n.$watch(function(){return d(n)},function(e,t){e!==t&&(w.pagination.start=0,o())})),this.sortBy=function(t,n){return w.sort.predicate=t,w.sort.reverse=n===!0,e.isFunction(t)?w.sort.functionName=t.name:delete w.sort.functionName,w.pagination.start=0,this.pipe()},this.search=function(t,n){var a=w.search.predicateObject||{},r=n?n:"$";return t=e.isString(t)?t.trim():t,s(r).assign(a,t),t||c(a,r),w.search.predicateObject=a,w.pagination.start=0,this.pipe()},this.pipe=function(){var e,s=w.pagination;f=w.search.predicateObject?C(I,w.search.predicateObject):I,w.sort.predicate&&(f=y(f,w.sort.predicate,w.sort.reverse)),s.totalItemCount=f.length,s.number!==t&&(s.numberOfPages=f.length>0?Math.ceil(f.length/s.number):1,s.start=s.start>=f.length?(s.numberOfPages-1)*s.number:s.start,e=f.slice(s.start,s.start+parseInt(s.number))),P(n,e||f)},this.select=function(e,s){var a=l(S(n)),i=a.indexOf(e);-1!==i&&("single"===s?(e.isSelected=e.isSelected!==!0,h&&(h.isSelected=!1),r.stSelectedRow&&(v(),m.assign(n,e),g()),h=e.isSelected===!0?e:t):a[i].isSelected=!a[i].isSelected)},this.slice=function(e,t){return w.pagination.start=e,w.pagination.number=t,this.pipe()},this.tableState=function(){return w},this.getFilteredCollection=function(){return f||I},this.setFilterFunction=function(e){C=a(e)},this.setSortFunction=function(e){y=a(e)},this.preventPipeOnWatch=function(){O=!1},this.toggleRow=function(e,t){E[e]=!E[e],I[t].$$treeIsExpanded=E[e],n.$apply(function(){p(I,t)})},this.checkExpanded=function(e){return E[e]},r.stSelectedRow&&g()}]).directive("stTable",function(){return{restrict:"A",controller:"stTableController",link:function(e,t,n,s){n.stSetFilter&&s.setFilterFunction(n.stSetFilter),n.stSetSort&&s.setSortFunction(n.stSetSort)}}}),e.module("smart-table").directive("stSearch",["stConfig","$timeout","$parse",function(e,t,n){return{require:"^stTable",link:function(s,a,r,i){var l=i,o=null,c=r.stDelay||e.search.delay,u=r.stInputEvent||e.search.inputEvent;r.$observe("stSearch",function(e,t){var n=a[0].value;e!==t&&n&&(i.tableState().search={},l.search(n,e))}),s.$watch(function(){return i.tableState().search},function(e){var t=r.stSearch||"$";e.predicateObject&&n(t)(e.predicateObject)!==a[0].value&&(a[0].value=n(t)(e.predicateObject)||"")},!0),a.bind(u,function(e){e=e.originalEvent||e,null!==o&&t.cancel(o),o=t(function(){l.search(e.target.value,r.stSearch||""),o=null},c)})}}}]),e.module("smart-table").directive("stSelectRow",["stConfig",function(e){return{restrict:"A",require:"^stTable",scope:{row:"=stSelectRow",onSelect:"=?stOnSelect"},link:function(t,n,s,a){var r=s.stSelectMode||e.select.mode;n.bind("click",function(){t.$apply(function(){a.select(t.row,r),s.stOnSelect&&t.onSelect(t.row)})}),t.$watch("row.isSelected",function(t){t===!0?n.addClass(e.select.selectedClass):n.removeClass(e.select.selectedClass)})}}}]),e.module("smart-table").directive("stSort",["stConfig","$parse","$timeout",function(n,s,a){return{restrict:"A",require:"^stTable",link:function(r,i,l,o){function c(){b?f=0===f?2:f-1:f++;var t;g=e.isFunction(d(r))||e.isArray(d(r))?d(r):l.stSort,f%3===0&&!!$!=!0?(f=0,o.tableState().sort={},o.tableState().pagination.start=0,t=o.pipe.bind(o)):t=o.sortBy.bind(o,g,f%2===0),null!==S&&a.cancel(S),0>P?t():S=a(t,P),p&&p(g,f)}var u,p,g=l.stSort,d=s(g),f=0,h=l.stClassAscent||n.sort.ascentClass,m=l.stClassDescent||n.sort.descentClass,v=[h,m],$=l.stSkipNatural!==t?l.stSkipNatural:n.sort.skipNatural,b=l.stDescendingFirst!==t?l.stDescendingFirst:n.sort.descendingFirst,S=null,P=l.stDelay||n.sort.delay;l.stOnSort&&(p=r.$eval(l.stOnSort)!==t?r.$eval(l.stOnSort):!1),l.stSortDefault&&(u=r.$eval(l.stSortDefault)!==t?r.$eval(l.stSortDefault):l.stSortDefault),i.bind("click",function(){g&&r.$apply(c)}),u&&(f="reverse"===u?1:0,c()),r.$watch(function(){return o.tableState().sort},function(e){e.predicate!==g?(f=0,i.removeClass(h).removeClass(m)):(f=e.reverse===!0?2:1,i.removeClass(v[f%2]).addClass(v[f-1]))},!0)}}}]),e.module("smart-table").directive("stPagination",["stConfig",function(e){return{restrict:"EA",require:"^stTable",scope:{stItemsByPage:"=?",stDisplayedPages:"=?",stPageChange:"&"},templateUrl:function(t,n){return n.stTemplate?n.stTemplate:e.pagination.template},link:function(t,n,s,a){function r(){var e,n,s=a.tableState().pagination,r=1,i=t.currentPage;for(t.totalItemCount=s.totalItemCount,t.currentPage=Math.floor(s.start/s.number)+1,r=Math.max(r,t.currentPage-Math.abs(Math.floor(t.stDisplayedPages/2))),e=r+t.stDisplayedPages,e>s.numberOfPages&&(e=s.numberOfPages+1,r=Math.max(1,e-t.stDisplayedPages)),t.pages=[],t.numPages=s.numberOfPages,n=r;e>n;n++)t.pages.push(n);i!==t.currentPage&&t.stPageChange({newPage:t.currentPage})}t.stItemsByPage=t.stItemsByPage?+t.stItemsByPage:e.pagination.itemsByPage,t.stDisplayedPages=t.stDisplayedPages?+t.stDisplayedPages:e.pagination.displayedPages,t.currentPage=1,t.pages=[],t.$watch(function(){return a.tableState().pagination},r,!0),t.$watch("stItemsByPage",function(e,n){e!==n&&t.selectPage(1)}),t.$watch("stDisplayedPages",r),t.selectPage=function(e){e>0&&e<=t.numPages&&a.slice((e-1)*t.stItemsByPage,t.stItemsByPage)},a.tableState().pagination.number||a.slice(0,t.stItemsByPage)}}}]),e.module("smart-table").directive("stPipe",["stConfig","$timeout",function(t,n){return{require:"stTable",scope:{stPipe:"="},link:{pre:function(s,a,r,i){var l=null;e.isFunction(s.stPipe)&&(i.preventPipeOnWatch(),i.pipe=function(){return null!==l&&n.cancel(l),l=n(function(){s.stPipe(i.tableState(),i)},t.pipe.delay)})},post:function(e,t,n,s){s.pipe()}}}}]),e.module("smart-table").directive("stTreeRow",["stConfig",function(){return{restrict:"A",require:"^stTable",priority:1001,compile:function(e,t){var n=t.ngRepeat,s=n.split(" in ")[0];e.attr("ng-repeat",n+" track by "+s+".$$treeId"),e.attr("ng-if",s+".$$treeShown"),e.attr("ng-class",'"st-tree-row-"+'+s+".treeLevel");var a=angular.element(e.find("td")[0]).find("st-tree-caret");a.attr("toggle-exists",s+".treeLevel > 0"),a.attr("toggle-is-expanded",s+".$$treeIsExpanded"),a.attr("toggle-level",s+".treeLevel"),a.attr("st-tree-id",s+".$$treeId"),a.attr("st-tree-level",s+".treeLevel"),a.attr("st-tree-index","$index")}}}]),e.module("smart-table").directive("stTreeCaret",["stConfig",function(){return{require:"^^stTable",scope:{toggleExists:"<",toggleIsExpanded:"<",toggleLevel:"<",stTreeId:"<",stTreeLevel:"<",stTreeIndex:"<"},templateUrl:"sttable/template/st-tree-toggle.html",link:function(e,t,n,s){e.toggleExists&&t.bind("click",function(t){t.stopPropagation(),s.toggleRow(e.stTreeId,e.stTreeIndex)}),e.spacerClass="st-tree-spacer st-tree-spacer-level-"+e.toggleLevel}}}])}(angular);
//# sourceMappingURL=smart-table.min.js.map
